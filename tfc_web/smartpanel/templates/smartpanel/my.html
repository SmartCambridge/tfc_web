{% extends "smartpanel/base.html" %}
{% load static %}
{% block content %}
        <div class="cards-section">
            <div class="cards-section-title mdl-typography--display-1-color-contrast">SmartPanel layouts</div>
            <div class="card-container mdl-grid">
                {% for smartpanel in smartpanels %}
                <div class="mdl-cell mdl-cell--3-col mdl-cell--4-col-tablet mdl-cell--4-col-phone mdl-card mdl-shadow--3dp">
                    <div class="mdl-card__media">
                        <img src="">
                    </div>
                    <div class="mdl-card__title">
                        <h4 class="mdl-card__title-text">Layout {{ smartpanel.name }}</h4>
                    </div>
                    <div class="mdl-card__supporting-text" style="padding-bottom: 125px;">
                        <span class="mdl-typography--font-light mdl-typography--subhead">
                            {% if edit %}Edit my SmartPanel layout{% else %}View the SmartPanel layout{% endif %}
                        </span>
                    </div>
                    <div class="mdl-card__actions">
                    {% if edit %}
                        <a class="aqua-link mdl-button mdl-js-button mdl-typography--text-uppercase"
                           href="{% url 'smartpanel-layout-config' smartpanel.slug %}">
                            Edit
                            <i class="material-icons">chevron_right</i>
                        </a>
                        <a class="delete-link aqua-link mdl-button mdl-js-button mdl-typography--text-uppercase" data-layout-id="{{ smartpanel.slug }}">
                            Delete <i class="material-icons" data-layout-id="{{ smartpanel.slug }}">chevron_right</i>
                        </a>
                    {% endif %}
                        <a class="aqua-link mdl-button mdl-js-button mdl-typography--text-uppercase"
                           href="{% url 'smartpanel-layout' smartpanel.slug %}" target="_blank">
                            View
                            <i class="material-icons">chevron_right</i>
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        <dialog id="dialog-delete" class="mdl-dialog">
            <div class="mdl-dialog__content">
                <p>
                    Are you sure you want to delete this layout?
                </p>
            </div>
            <div class="mdl-dialog__actions mdl-dialog__actions--full-width">
                <form action="{% url 'smartpanel-layout-delete' %}" method="post">
                    {% csrf_token %}
                    <input id="form_delete_layout_id" type="hidden" name="layout_id">
                    <input type="submit" class="mdl-button" value="Yes">
                    <button type="button" class="mdl-button close">No</button>
                </form>
            </div>
        </dialog>
{% endblock %}
{% block lazy_script %}
    <script>
        var dialog_delete = document.querySelector('#dialog-delete');
        var deleteModalButtons = document.querySelectorAll('.delete-link');
        if (! dialog_delete.showModal) {
            dialogPolyfill.registerDialog(dialog_delete);
        }
        for (var i = 0; i < deleteModalButtons.length; i++) {
            deleteModalButtons[i].addEventListener('click', function(event) {
                dialog_delete.showModal();
                document.querySelector('#form_delete_layout_id').value = event.target.dataset.layoutId;
            });
        }
        dialog_delete.querySelector('.close').addEventListener('click', function() {
            dialog_delete.close();
        });

        $(function () {
            $(".delete-link").click(function (e) {
                e.preventDefault();
                $(e.currentTarget).parent().submit();
            })
        })
    </script>
{% endblock %}